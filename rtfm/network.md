Network
#
문제유형
- 통신 내용이 기록된 파일에서 FLAG를 찾는 문제
- 서버에 접근해서 FLAG를 입수하는 문제

#
`통신이 기록된 파일 내에서 FLAG를 찾는 문제`

- TCP/IP 통신 패킷
- USB 통신 패킷
- 무선 LAN 통신 패킷
- 블루투스 통신 패킷

#
`서버에 접근해서 FLAG를 입수하는 문제`

- IP 주소, FQDN, 호스트명, URL, 포트번호와 같은 주소 정보
    - 포트스캔
    - 열려있는 포트에 응용프로그램을 사용해 접근 시도
    - 소켓 통신을 이용해 접근 시도
    - 위 시도를 할 때 패킷 캡쳐를 수행
- 패킷이 기록된 파일
    - 어떤 주소에 어떤 프로토콜을 사용해서 접근했는지 찾음
    - 대상 서버를 찾고 어떤식으로 통신이 이뤄졌는지 분석
    - 통신을 재현해서 서버에 접속한 뒤 FLAG를 획득
#
`패킷 분석`

- 파일 형식
    - libpcap(Packet capture library) 형식
        - 패킷을 기록하는 기본형식
        - tcpdump나 와이어사크 같은 libpcap(윈도우라면 WinPcap) 라이브러리를 이용한 네트워크 도구에서 패킷을 캡쳐하고 그 결과를 저장하기 위해 주로 사용하는 파일 형식
    - PcapNg(PCAP Next Generation) 파일 형식
        - .pcapng
        - libpcap에서 다양한 메타데이터를 추가할 수 있게 발전시킴
        - 패킷캡쳐를 한 인터페이스 정보(인터페이스 이름, IP 주소, MAC 주소 등)
        - 캡쳐 파일 전체 또는 패킷에 주석 추가
        - DNS 등 이름 확인 정보
        - `0A 0D 0D 0A`라는 바이너리 문자열로 시작

![image](https://user-images.githubusercontent.com/61821641/155860615-a901222a-c082-467f-84ce-4cd1f37725b9.png)
- pcap 파일 구조
    - libpcap 헤더
        - pcap 파일 자체의 정보를 저장
        - Magic Number `D4 C3 B2 A1`(빅엔디안의 경우 `A1 B2 C3 D4`): pcap 파일을 판별하는 부분
        - Major Version: 2바이트
        - Minor Version: 2바이트
        - 현재 버전은 2.4이면 major v는 `0x0002`, minor v는 `0x0004`
        - timezon: 4바이트/ 기본값: `0x00000000`
        - 타임스탬프 정확도: 4바이트/ 기본값: `0x00000000`
        - 캡쳐할 수 있는 패킷의 최대 길이: 4바이트/ 기본값: `0x0000FFFF`
        - 데이터링크 계층의 헤더 종류: 4바이트/ 기본값: `0x00000001`
    - 패킷 헤더
        - 패킷당 정보 저장
        - 패킷 캡쳐했을 때의 타임스탬프
            - 앞의 4바이트는 날짜를 나타내며 유닉스 시간 형식으로 저장
            - 뒤의 4바이트는 마이크로초를 나타냄
        - 패킷 길이
            - caplen: 4바이트
                - 파일에 기록된 패킷 길이
            - len: 4바이트
                - 실제 패킷 길이
            - caplen과 len이 다른 경우는 pcap의 snaplen보다 큰 패킷이 캡쳐된 경우
    - 패킷 데이터